[
  {
    "$group": {
      "_id": "$userId",
      "total": { "$sum": "$total" },
      "count": { "$sum": 1 }
    }
  },
  { "$sort": { "total": -1 } }
]
